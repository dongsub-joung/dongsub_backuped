---
title: 도서 관리 프로그램(8) -대출 기능 구현
tag: 도서관리
---



> _나의 가치는 내가 증명하는 것이다._

## 전체적인 맵

![1](https://user-images.githubusercontent.com/59364300/75621162-a359ff00-5bd4-11ea-8760-c6b9bd71e3b7.JPG)

+ 대출 버튼을 누르면 새로운 창이 열리면서 거기에 학번, 이름, 번호를 입력 받기를 원함.
+ 입력받은 정보는 엑셀 데이터로 저장 혹은 파일의 형식으로 저장
+ 검색창에 이러한 정보를 프로그램 기동 했을 때 로딩되어 출력되길 원함.

---

## 03.02 Am 03:00~07:00

> checkOutF.java

+ 메소드 추가

```
	public  void saveData(String personNum, String name, String PH)
	{
		FileOutputStream outStream = null;

		try {
			//파일을 읽어옴
			String filepath = "C:/Users/ehdtj/OneDrive/바탕 화면/Web/bookControl/UI/info.xlsx";
			FileInputStream xlsxFile = new FileInputStream(filepath);
			//엑셀 객체화
			XSSFWorkbook workbook = new XSSFWorkbook(xlsxFile);
			//엑셀 1번째 시트를 받아옴
			XSSFSheet sheet = workbook.getSheetAt(0);
			//시트 객체에서 row 수를 받아옴
			int row = sheet.getPhysicalNumberOfRows();
			
			for(int rowNum=0; rowNum<5; rowNum++)
			{
				XSSFRow xlsxRow = sheet.getRow(rowNum);
				
				//셀 값
				int cells = xlsxRow.getPhysicalNumberOfCells();
				for(int cellNum=0; cellNum<5; cellNum++)
				{
					//셀 값을 불러옴
					String cell = xlsxRow.getCell(cellNum).toString();
					if(cell == null)
					{
						int a = cellNum%3;
						if(a == 1) xlsxRow.createCell(cellNum).setCellValue(personNum);
						if(a == 2) xlsxRow.createCell(cellNum).setCellValue(name);
						if(a == 0) xlsxRow.createCell(cellNum).setCellValue(PH);
					}
				}
			} //반복 끝
			
			outStream = new FileOutputStream(filepath);
			workbook.write(outStream);
		
			xlsxFile.close();
			
		} catch (Exception e) {
			// TODO: handle exception
		}
```

   

---


> coverF_secon.java //두번째 프레임

대출 버튼을 눌렀을 때 실행됨.
개인정보 입력


```
		JButton btnNewButton = new JButton("Submit");
		btnNewButton.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) 
			{
				//각각의 텍스트 필드에서 입력값을 가져옴
				String personData = textField.getText();
				String name = textField_1.getText();
				String PHData = textField_2.getText();

				checkOutF check = new checkOutF();
				check.saveData(personData, name, PHData);
				
				//값을 초기화
				textField.setText("");
				textField_1.setText("");
				textField_2.setText("");
			}
		});
```




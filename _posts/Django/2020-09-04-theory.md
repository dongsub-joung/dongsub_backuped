---
title: Django 이론 (1)
tag: django
---







## Django Views

### 정의

 View들은 Django App 안의 views.py 라는 파일에 정의하게 되는데, 각 함수가 하나의 View를 정의한다. 각 View는 HTTP Request를 입력 파라미터로 받아들이고, HTTP Response를 리턴한다.

 View는 (1) 웹페이지 내용을 갖는 HttpResponse 객체를 리턴하거나 (2) Http404 같은 Exception을 리턴한다.

#### 404

```python
from django.http import Http404, HttpResponseNotFound

def error(request):
	#return HttpResponseNotFound('<h1> not found </h1>')
	raise Http404("Not Found")
```



### MTV 패턴

MTV에서의 Model은 데이타를 표현하는데 사용되며, 하나의 모델 클래스는 DB에서 하나의 테이블로 표현된다.

MTV의 View는 HTTP Request를 받아 그 결과인 HTTP Response를 리턴하는 컴포넌트로서, Model로부터 데이타를 읽거나 저장할 수 있으며, Template을 호출하여 데이타를 UI 상에 표현하도록 할 수 있다. 

MTV의 Template은 Presentation Logic 만을 갖는데 HTML을 생성하는 것을 목적으로 하는 컴포넌트이다.



## Django Template

 "App폴더/templates/App명/템플릿파일" 처럼, 각 App 폴더 밑에 templates 서브폴더를 만들고 다시 그 안에 App명을 사용하여 서브폴더를 만든 후 템플릿 파일을 그 안에 넣기를 권장한다 (예: /home/templates/home/index.html ).

 대부분의 경우 View로부터 어떤 데이타를 전달받아 HTML 템플릿 안에 그 데이타를 동적으로 치환해서 사용한다. 

1. 먼저 View (home/views.py)에서 다음과 같이 index()를 정의

```python
from django.shortcuts import render

def index(request):
    msg= 'My Message'
    return render(request, 'index.html', {'message': msg})
```

- `render`

  - func in django.shrtcuts 패키지

  - (request, template, optional)

    - template은 home/templates/index.htm를 가리키게 됨(ex)

    - optional

      View에서 템플릿에 전달한 데이타를 Dictionary로 전달한다. 

2. 다음으로 Template (home/templates/index.html)에 HTML 문서를 작성한다. 

Django의 템플릿에서 `{{ 변수명 }}` 은 해당 변수의 값을 그 자리에 치환하라는 의미를 갖는다.

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <h1>{{message}}</h1>
</body>
</html>
```



### 템플릿 설정

Django에서는 여러 템플릿 엔진을 선택하여 사용할 수 있으며, 이 셋팅은 Django 프로젝트의 settings.py 에서 할 수 있다. 


### Django 템플릿 언어

#### 템플릿 변수

```django
<h4>
  Name : {{ name }}
  Type : {{ vip.key }}
</h4>
```

#### 템플릿 태그

```django
{% if count > 0 %}
    Data Count = {{ count }}
{% else %}
    No Data
{% endif %}
 
{% for item in dataList %}
  <li>{{ item.name }}</li>
{% endfor %}
 
{% csrf_token %}
```

#### 템플릿 필터

템플릿 필터는 변수의 값을 특정한 포맷으로 변형하는 기능을 한다. 

```django
날짜 포맷 지정
{{ createDate|date:"Y-m-d" }}
 
소문자로 변경
{{ lastName|lower }}
```

#### 코멘트

```django
{# 1 라인 코멘트 #}
 
{% comment %}  
  <div>
      <p>
          불필요한 블럭
      </p>
      <span></span>
  </div>
{% endcomment %}
```



#### HTML Escape

```django
% autoescape on %}     # autoescape 태그
    {{ content }}
{% endautoescape %}
 
{{ content|escape }}    # escape 필터
```





